This part is taken from CityDPC and modified to work with TECDEM. We are grateful for the work of the CityDPC team. Original code can be found here: https://github.com/RWTH-E3D/CityDPC 